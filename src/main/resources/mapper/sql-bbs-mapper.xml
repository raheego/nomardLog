<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

 <mapper namespace="com.encore.bbs.board.mapper.BbsMapper">
	<!-- 게시글 상세정보 sql-->
	<select id="selectBbsDetail" resultType="BbsDTO">
		SELECT *, ct.continent_name, c.country_name
		FROM bbs b
		JOIN countries c ON b.country_id = c.country_id
		JOIN continents ct ON c.continent_id = ct.continent_id
		WHERE bbs_id = #{bbsId};
	</select>
	<!--게시글 저장 sql-->
		<insert id="insertBbs" useGeneratedKeys="true" keyProperty="bbsId" parameterType="BbsDTO">
			INSERT INTO bbs(title, contents)
			VALUES (#{title}, #{contents});
		</insert>
	<!--게시글 전체 목록-->
	<select id="getBbsAllList" resultType="BbsDTO">
		SELECT * FROM bbs;
	</select>
	<!--MainPage 정보 불러오기-->
	<select id="getText" resultType="BbsDTO">
		SELECT title, contents FROM bbs WHERE bbs_id = 1;
	</select>
	<!--국가정보 넣기-->
	<select id="getCountryList" resultType="BbsDTO">
		SELECT * FROM countries;
	</select>

	<select id="insertCountryBbs" resultType="BbsDTO">
		SELECT country_id
		FROM countries
		WHERE country_name = #{countryName};
	</select>

	<insert id="insertHashtag" useGeneratedKeys="true" keyProperty="hashtagId" parameterType="hashTag">
		INSERT INTO hashtag(bbs_id, content)
		VALUES (#{bbsId}, #{content});
	</insert>

	<!-- 최근 저장한 게시물 id-->
	<select id="getLatestBbsId" parameterType="Long">
		SELECT LAST_INSERT_ID()
	</select>

	<!-- 해시태그 게시판 노출-->
	<select id="selectHashtag" parameterType="hashtag" resultType="hashtag">
		SELECT *
		FROM hashtag WHERE bbs_id = #{bbsId};
	</select>
</mapper>
<!--	<select id="selectBbsList" resultType="BbsDTO"> &lt;!&ndash; resultMap="BbsList" &ndash;&gt;-->
<!--		SELECT * FROM bbs-->
<!--	</select>-->
<!--	<insert id="insertBbs" parameterType="BbsDTO">-->
<!--	<![CDATA[-->
<!--		INSERT INTO bbs -->
<!--		(-->
<!--			title,-->
<!--			contents,-->
<!--			created_at -->
<!--		)-->
<!--		VALUES-->
<!--		(-->
<!--			#{title},-->
<!--			#{contents},-->
<!--			NOW()-->
<!--		)-->
<!--	]]>-->
<!--	</insert>-->
<!--	<update id="updateViewCount" parameterType="int">-->
<!--	 <![CDATA[-->
<!--	    UPDATE bbs-->
<!--	    SET view_cnt = view_cnt+1-->
<!--	    WHERE bbs_id = #{bbsId}-->
<!--	 ]]>-->
<!--	</update>	-->
<!--	<select id="selectBbsDetail" parameterType="int" resultType="com.encore.bbs.dto.BbsDTO">-->
<!--  	<![CDATA[-->
<!--	     SELECT bbs_id, -->
<!--	    		title, -->
<!--	    		contents, -->
<!--	    		view_cnt, -->
<!--	    		DATE_FORMAT(created_at, '%Y.%m.%d %H:%i:%s') -->
<!--	   		 	as created_at, -->
<!--	    		member_code-->
<!--	    	FROM -->
<!--	    		bbs-->
<!--	    	WHERE -->
<!--	    		bbs_id=#{bbsId} AND is_deleted='N'-->
<!--  	]]>-->
<!--	</select>-->
<!--	<update id="updateBbs" parameterType="com.encore.bbs.dto.BbsDTO">-->
<!--  	<![CDATA[-->
<!--	    UPDATE bbs SET-->
<!--	     	title = #{title}, -->
<!--	    	contents = #{contents},  -->
<!--	    	modify_at = NOW()-->
<!--	    WHERE -->
<!--	    	bbs_id=#{bbsId}-->
<!--  	]]>-->
<!--	</update>-->
<!--	<update id="deleteBbs" parameterType="int">-->
<!--  	<![CDATA[-->
<!--	    UPDATE bbs SET-->
<!--	     	is_deleted = '1', -->
<!--	    	modify_at = NOW()-->
<!--	    WHERE -->
<!--	    	bbs_id=#{bbsId}-->
<!--  ]]>-->
<!--</update>-->

<!--	<select id="getCategoryList" resultType="categoryDto">-->
<!--		SELECT * FROM CATEGORY;-->
<!--	</select>-->

<!--</mapper>-->